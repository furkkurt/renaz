---
import whatsappIcon from '../assets/whatsapp.svg';
import phoneIcon from '../assets/phone.svg';
---

<div class="contact-buttons fixed bottom-6 z-50 flex gap-3 right-6 translate-x-full opacity-0 transition-all duration-500 ease-in-out">
  <!-- Phone Button - Left (Mobile Only) -->
  <a
    href="tel:05346706294"
    class="bg-[#25D366] hover:bg-[#20BA5A] rounded-lg px-4 py-3 shadow-lg hover:shadow-xl transition-all duration-300 block md:hidden flex items-center gap-2 text-white font-semibold"
    aria-label="Telefon ile iletişime geç"
  >
    <img
      src={phoneIcon.src}
      alt="Telefon"
      class="w-5 h-5 brightness-0 invert"
    />
    <span class="text-sm">Hemen Ara</span>
  </a>

  <!-- WhatsApp Button - Right -->
  <a
    href="https://wa.me/905346706294"
    target="_blank"
    rel="noopener noreferrer"
    class="bg-[#25D366] hover:bg-[#20BA5A] rounded-lg px-4 py-3 shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 text-white font-semibold"
    aria-label="WhatsApp ile iletişime geç"
  >
    <img
      src={whatsappIcon.src}
      alt="WhatsApp"
      class="w-5 h-5 brightness-0 invert"
    />
    <span class="text-sm">WhatsApp'tan Yaz</span>
  </a>
</div>

<script>
  (function() {
    const contactButtons = document.querySelector('.contact-buttons') as HTMLElement;
    if (!contactButtons) return;

    let scrollTimer: ReturnType<typeof setTimeout> | null = null;
    let hideTimer: ReturnType<typeof setTimeout> | null = null;
    let isScrolling = false;

    function showButtons() {
      // Clear any existing hide timer
      if (hideTimer) {
        clearTimeout(hideTimer);
        hideTimer = null;
      }

      // Show buttons with slide-in animation
      contactButtons.classList.remove('translate-x-full', 'opacity-0');
      contactButtons.classList.add('translate-x-0', 'opacity-100');
      
      // Set timer to hide after 3 seconds
      hideTimer = setTimeout(() => {
        hideButtons();
      }, 3000);
    }

    function hideButtons() {
      // Hide buttons with slide-out animation
      contactButtons.classList.remove('translate-x-0', 'opacity-100');
      contactButtons.classList.add('translate-x-full', 'opacity-0');
      
      if (hideTimer) {
        clearTimeout(hideTimer);
        hideTimer = null;
      }
    }

    function handleScroll() {
      if (!isScrolling) {
        isScrolling = true;
        showButtons();
      }

      // Reset scroll timer
      if (scrollTimer) {
        clearTimeout(scrollTimer);
      }

      scrollTimer = setTimeout(() => {
        isScrolling = false;
        // After scrolling stops, buttons will auto-hide after 3 seconds (handled by hideTimer)
      }, 150);
    }

    // Listen to scroll events
    window.addEventListener('scroll', handleScroll, { passive: true });

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (scrollTimer) clearTimeout(scrollTimer);
      if (hideTimer) clearTimeout(hideTimer);
    });
  })();
</script>

<style>
  .contact-buttons {
    transform: translateX(100%);
    opacity: 0;
  }
  
  .contact-buttons.translate-x-0 {
    transform: translateX(0);
  }
  
  .contact-buttons.opacity-100 {
    opacity: 1;
  }
</style>
